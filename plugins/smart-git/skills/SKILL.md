---
description: "PRを作成して、プルリクエストを作って、PRを出して などのリクエストに対応"
---

# PR作成スキル

このスキルは、ユーザーがPR作成を求めたときに起動します。

## 発動条件

以下のような発話があったときに使用：
- 「PRを作成して」
- 「プルリクエストを作って」
- 「PRを出して」
- 「プルリク作って」
- 「PRお願い」

## 0. 事前チェック

以下のコマンドを実行して環境を確認：

### GitHub CLI の確認

`gh --version` を実行。

**インストールされていない場合**、以下のメッセージを表示して処理を中断：

---

**GitHub CLI (`gh`) がインストールされていません。**

PR作成には GitHub CLI が必要です。以下の方法でインストールしてください：

**macOS (Homebrew):**
```bash
brew install gh
```

**Ubuntu/Debian:**
```bash
sudo apt install gh
```

**Windows (winget):**
```bash
winget install GitHub.cli
```

インストール後、以下で認証を行ってください：
```bash
gh auth login
```

詳細: https://cli.github.com/

---

### 認証状態の確認

`gh auth status` を実行。

**未認証の場合**、以下のメッセージを表示して処理を中断：

---

**GitHub CLI の認証が必要です。**

以下のコマンドで認証してください：
```bash
gh auth login
```

---

## 実行内容

### 1. 変更状況の確認

`git status` で以下を確認：
- ステージング済みの変更
- 未ステージングの変更
- 未追跡ファイル

### 2. 分岐処理

#### 変更がある場合

AskUserQuestion ツールで確認：
- 質問：「コミットされていない変更があります。どうしますか？」
- 選択肢：
  - 「コミットしてからPRを作成」 → Phase A（コミット＋PR）へ
  - 「変更を無視してPRを作成」 → Phase B（PRのみ）へ
  - 「キャンセル」 → 処理を中断

#### 変更がない場合

そのまま Phase B（PRのみ）へ

---

## Phase A: コミット＋PR作成

/commit-and-pr コマンドと同等の処理を実行：

1. ステージング確認（必要に応じて `git add`）
2. Conventional Commits形式でコミットメッセージ生成
3. コミット実行
4. PRタイトル決定（ユーザー入力 or 自動生成）
5. PR説明文生成
6. ドラフト確認
7. プッシュ
8. `gh pr create`
9. 結果表示

---

## Phase B: PRのみ作成

/create-pr コマンドと同等の処理を実行：

1. ブランチ確認（mainならエラー、差分なしならエラー）
2. PRタイトル決定（ユーザー入力 or 自動生成）
3. PR説明文生成
4. ドラフト確認
5. プッシュ
6. `gh pr create`
7. 結果表示

---

## 結果表示

- 作成されたPRのURL
- PRタイトル
- ドラフト/通常の区別
- （Phase Aの場合）コミットハッシュ、コミットメッセージ
